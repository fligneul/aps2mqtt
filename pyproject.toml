[build-system]
requires = ["setuptools>=80.9"]
build-backend = "setuptools.build_meta"

[project]
name = "aps2mqtt"
dynamic = ["version"]
description = "Access APSystems ECU data over MQTT"
readme = "README.md"
requires-python = ">=3.9, <3.14"
license = "GPL-3.0-or-later"
license-files = ["LICENSE"]
authors = [
    { name = "Florian Ligneul", email = "contact@florian-ligneul.fr" },
]
keywords = ["mqtt", "ap-systems", "ecu", "iot", "solar", "home-automation"]
urls = { Homepage = "https://github.com/fligneul/aps2mqtt" }
classifiers = [
    "Operating System :: OS Independent",
    "Programming Language :: Python :: 3",
    "Programming Language :: Python :: 3.9",
    "Programming Language :: Python :: 3.10",
    "Programming Language :: Python :: 3.11",
    "Programming Language :: Python :: 3.12",
    "Programming Language :: Python :: 3.13",
    "Topic :: Home Automation",
]
dependencies = [
    "requests~=2.32",
    "paho.mqtt~=2.1",
    "pyyaml~=6.0",
    "numpy~=2.3",
    "suntime~=1.2",
    "str2bool~=1.1",
    "tzdata>=2025.2",
]

[tool.setuptools.dynamic]
version = { attr = "aps2mqtt.__version__" }

[tool.black]
line-length = 100

[tool.semantic_release]
version_variables = ["src/aps2mqtt/__init__.py:__version__"]
commit_message = "[release] {version}\n\nAutomatically generated by python-semantic-release"
commit_parser = "conventional"
major_on_zero = true
tag_format = "v{version}"
build_command = "pip install -r requirements.txt && python -m build"

[tool.semantic_release.branches.main]
match = "(main|master)"
prerelease_token = "rc"
prerelease = false

[tool.semantic_release.changelog]
mode = "update"
template_dir = "templates"

[tool.semantic_release.changelog.default_templates]
changelog_file = "CHANGELOG.md"

[tool.semantic_release.commit_parser_options]
allowed_tags = ["build", "chore", "ci", "docs", "feat", "fix", "perf", "style", "refactor", "test"]
minor_tags = ["feat"]
patch_tags = ["fix", "perf"]

[tool.semantic_release.publish]
dist_glob_patterns = ["dist/*"]
upload_to_vcs_release = true

[tool.pytest.ini_options]
pythonpath = "src"